package com.comviva.pos.dao;

import java.sql.Connection;
//import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;

import javax.swing.JOptionPane;

import com.comviva.pos.bean.CartBean;
import com.comviva.pos.bean.CredentialsBean;
import com.comviva.pos.bean.FoodBean;
import com.comviva.pos.bean.StoreBean;
import com.comviva.pos.util.DBUtil;

public class CustomerDao {
	
	public static Connection con= DBUtil.con;
	public static PreparedStatement ps;
	public static ResultSet rs;
	CredentialsBean crBean=new CredentialsBean();
	StoreBean sb=new StoreBean();
	
	public String addToCart(CartBean cb, CredentialsBean cr, FoodBean fb) {
		int i=0;
		
		try {
			ps=con.prepareStatement("insert into pos_tbl_cart values(?,?,?,?,?,?,?)");
			ps.setInt(1, cb.getCartID());
			ps.setString(2, cr.getUserID());
			ps.setString(3, fb.getFoodID());
			ps.setString(4, cb.getType());
			ps.setInt(5, cb.getQuantity());
			ps.setDouble(6, cb.getCostl());
			ps.setDate(7,cb.getOrderdate());
						
			i=ps.executeUpdate();
		} 
		catch (SQLException sql) {
			System.out.println(sql);
		}
		
		if (i==1) {
			return "SUCCESS";
		} else if (i==0){
			return "FAIL";
		}
		else {
			return "ERROR";
		}
	}
	
	
	public Boolean modifyCart(CartBean ctBean, CredentialsBean crBean, FoodBean fb) {
		int i=0;
		
		try {
			ps=con.prepareStatement("update pos_tbl_cart set Userid=?,FoodId=?,Type=?,Quantity=?,Cost=?,OrderDate=? where CartId=?");
			
			ps.setString(1, ctBean.getUserID());
			ps.setString(2, fb.getFoodID());
			ps.setString(3, ctBean.getType());
			ps.setInt(4, ctBean.getQuantity());
			ps.setDouble(5, ctBean.getCostl());
			ps.setDate(6, ctBean.getOrderdate());
			ps.setInt(7, ctBean.getCartID());
						
			i=ps.executeUpdate();
		} 
		catch (SQLException sql) {
			System.out.println(sql);
		}
		
		if (i==1) {
			JOptionPane.showMessageDialog(null, "Update SUCCESSFUL");
			return true;
		}
		else {
			JOptionPane.showMessageDialog(null, "Update UN-SUCCESSFUL");
			return false;
		}
	}
	
	public int deleteCart(CartBean ctBean) {
		int i=0;
		
		try
		{
			ps=con.prepareStatement("delete from pos_tbl_cart where CartId=?");
			ps.setInt(1, ctBean.getCartID());
			
			i=ps.executeUpdate();
		}
		catch(SQLException sql)
		{
			System.out.println(sql);
		}

		return i;
	}
	
	public ArrayList<CartBean> viewCart(CredentialsBean crBean) {
		ArrayList<CartBean> arcb=new ArrayList<CartBean>();
		
		try
		{
			ps=con.prepareStatement("select * from pos_tbl_cart where Userid=?");
			ps.setString(1, crBean.getUserID());
			rs= ps.executeQuery();
			
			while(rs.next()) {
	            CartBean cb=new CartBean();
	            cb.setExp(rs.getString(1)+"    "+rs.getString(2)+"    "+rs.getString(3)+"    "+rs.getString(4)+"    "+rs.getString(5)+"    "+rs.getString(6)+"    "+rs.getString(7));

	            arcb.add(cb);
	            }
		}
		catch(SQLException sql)
		{
			System.out.println(sql);
		}
		return arcb;
	}



	
	


}
